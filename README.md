# context-Scope
    执行环境及作用域
    执行环境在JavaScript中是一个很重要的概念，定义了js文件执行过程中变量或者函数有权访问的其他数据。
    每个执行环境都有一个与之关联的变量对象，环境中定义的所有变量和函数都定义在这个对象中，可以将这个对象理解为普通的js对象，需要注意的是这个对象不能被我们访问，解析器在处理数据时在后台调用这个对象。当进入js文件时，首先进入的是全局执行环境这个环境保存着全局变量以及函数定义，全局执行环境是当程序退出时才会被销毁。当进入函数中时，会进入函数执行环境，此环境中保存着函数中定义的局部变量或者内部定义的函数。
## 变量对象（如果执行环境是函数则将活动对象作为变量对象）
EC建立分为两个阶段：进入执行上下文和执行阶段。

1.进入上下文阶段：发生在函数调用时，但是在执行具体代码之前（比如，对函数参数进行具体化之前）

2.执行代码阶段：变量赋值，函数引用，执行其他代码。

我们可以将EC看做是一个对象。
```javascript
EC={
    VO:{/* 函数中的arguments对象, 参数, 内部的变量以及函数声明 */},
    this:{},
    Scope:{ /* 父执行上下文中的VO*/}
}
```
### VO
#### 进入上下文阶段
当进入上下文阶段，VO的初始化过程具体如下：

* 初始化arguments对象
    *  初始化callee
    *  初始化length
* 初始化环境中的函数声明，将函数名作为AO对象的属性，如果后面定义相同函数名，则会覆盖前面的定义（表现就是对于函数中定义两个相同函数名的函数，只会执行最后一个函数）
* 变量声明，将变量名作为VO对象的属性，初始化值为undefined，如果定义的变量名称在前面已经定义，就会跳过将变量名添加到AO对象中（表现就是当定义的变量名称与定义的函数名称相同时，在执行到变量赋值语句后AO对象对应的属性值才会改变为变量值）

#### 执行代码阶段
执行代码的同时会将变量初始化的值undefined变为赋给的值。


### 函数提升
通过上面所说的VO初始化过程我们可以看出，函数提升的本质是在初始化变量对象时先初始化定义的函数。
```javascript
function foo(){
  console.log(a);  //function a(){console.log("a2")}
  function a (){console.log("a1")};
  console.log(a);  //function a(){console.log("a2")}
  function a (){console.log("a2")};
  console.log(a);  //function a(){console.log("a2")}
  var a;
  console.log(a);  //function a(){console.log("a2")}
  a = 1;
  console.log(a);  //1
}
```
关于变量复制可以参考[js变量（基本类型，引用类型）复制和传参机制](https://github.com/zcjGitHub/jsVariable)